## 谈重复数据删除技术的风险和预防之策

原创 *2016-05-22* *EMC中文技术社区* [EMC易安信中国技术社区](https://mp.weixin.qq.com/s?__biz=MjM5NjY0NzAwMg==&mid=2651770919&idx=1&sn=afff3255a66fa37004f824ba02357608&scene=21##)

大家都知道，把所有鸡蛋都放到同一个篮子不是一个好主意。

 

其实，许多中小企业的备份管理员很容易犯一个错误，这也是重复数据删除所带来的风险。

 

这个错误就是：使用重复数据删除技术却不对数据进行复制（比如克隆）。

 

无论你用的是哪种重复数据删除系统，都得使用Raid不是吗？如EMC的重复数据删除产品Avamar和Data Domain，部署的时候都离不开Raid。

 

大家都知道，Raid虽然可以保护数据因为磁盘损坏而丢失，但是它无法防止人为的误操作，比如不小心误删了数据。

 

所以，与传统备份方式相比较，重复数据删除技术就好比把所有的鸡蛋放到了一个篮子里。为了更好的理解重复数据删除技术带来的风险，我们通过举例来说明：

 

[![img](https://mmbiz.qpic.cn/mmbiz/TztEwAzAQIXClPplbwicH0ksJVHqzzEkuU2ytC92A387uz6jTYJmHp9AHwkvTd7du1dTEQs0tBKtfV9mUL8icxiaw/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&retryload=1)]()

 

如上图所示，假如我们每周做一次1.1TB的完全备份，其他几天都作增量备份且平均增量备份的数据量是0.1TB。这样每周我们备份的总量是1.1TB+0.1TB*6=1.7TB。3个星期后我们的备份总量是1.7TB*3=5.1TB。

 

下面我们来看一看同样情况下使用重复数据删除技术的情形：

 

[![img](http://mmbiz.qpic.cn/mmbiz/TztEwAzAQIXClPplbwicH0ksJVHqzzEkugF6tSeQIsBsRebWZwcRHjU9We0koZmibTibHJNZJcMgLiahP3jO4Tbb9Q/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1)]()

 

如上图我们可见，使用重复数据删除技术以后，第一周备份的数据量是1.7TB，第二和第三周备份的数据量分别是0.6TB（增量备份的那部分），所以到第2周为止备份总量是2.3TB，到第3周为止备份总量是2.9TB。

 

可以看到，使用重复数据删除技术以后，备份的数据量大大减少了。为什么会这样呢？因为重复数据删除技术消除了冗余，不存储额外的数据副本，相同的数据只存储一份。

 

由此可见，重复数据删除技术就好比把所有的鸡蛋放入一个篮子里。如果你不小心删除了备份数据，或者整个Raid出现了问题，那么你不仅仅是丢失这一部分的备份，而是会丢失所有涉及该数据的所有备份，这可能会导致你一无所有，造成无法承受的损失。这点你绝对需要引起重视。

 

**那么有何预防之策呢？**

 

当然有。其实方法也很简单，这就是：使用重复数据删除技术的时候，对数据做复制（比如做克隆）。这样数据才能得到保护，也就等同于在另一个篮子中放一模一样的一篮鸡蛋了。

 

虽然克隆对于不使用重复数据删除技术的环境也很重要，但是即使你在不使用重复数据删除技术的环境中没有做克隆，你仍旧有机会来弥补数据丢失的损失。这是因为你有数据的多个副本，比方说假如你想恢复第2周的数据但是失败了，但是至少你还有第1周和第3周的完全备份，可以用来恢复第1周或第3周的数据。虽然会损失一部分数据，但至少大多数数据都还完好无缺。

 

说到这里，大家应该都已经明白，我们在使用重复数据删除技术的时候，一定要记得对数据做复制。Deduplication = Replication。如果你还没有这样做的话，那么你做的是不正确的。赶紧复制一份鸡蛋放到另一个篮子里吧。