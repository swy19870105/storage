## 存储网络 – FCoE与FCIP间的小同大异

原创 *2016-08-02* *EMC中文技术社区* [EMC易安信中国技术社区](https://mp.weixin.qq.com/s?__biz=MjM5NjY0NzAwMg==&mid=2651771261&idx=3&sn=ba9a1a50fb9259a47dbe9be95a38b631&scene=21##)

​     FCoE和FCIP都是将Fibre Channel（FC）协议运行于非光纤网络载体的存储传输协议。它们将FC协议封装在网络OSI模型的不同层中，这种封装技术上实现的区别使得FCoE和FCIP在应用和部署上有所不同。本文就FCoE和FCIP区别入手，描述FCoE和FCIP两种存储网络协议的共同点和，区别，以及对应的不同应用场景。作为读者在选择网络存储架构的参考。

 

​     FCoE的全称是Fiber Channel over Ethernet，是通过以太网直接传输光纤协议，让存储网络中的数据可轻易跨越光纤和以太网的界限，通过同一种截物理介质（以太网络）进行传输，同时保留了FC中的上层协议的特性，例如数据一致性，流控制等，但不使用原先光纤网络的物理线路与接口。目的在于降低用户在存储网络构建和管理方面的成本和复杂性。（参考：[存储网络 – 了解FCoE的8个技术细节](http://mp.weixin.qq.com/s?__biz=MjM5NjY0NzAwMg==&mid=2651771250&idx=2&sn=8af2f2f49d5727cd0205125bfb4563de&scene=21#wechat_redirect)）

​     FCIP的全称是Fibre Channel over Internet Protocol，是通过运行于以太网中的IP通道来传输FC协议，使得可以将两个距离比较远的FC SAN网络连接在一起，组成一个更大的存储网络。它的好处是无需在两地之间再部署光纤网络，就可以实现使用现有的IP网络传输FC协议。

**FCoE和FCIP在应用上有一些共同点：**

- 都可以利用现有的以太网/IP网络对存储网络进行扩展与融合。
- 都是把FC协议封装在不同的数据包中进行传输，而FC协议中内部都是SCSI命令。
- 都需要额外购置专用的设备，FCoE需要添置FC和以太网融合的交换机支持无损以太网传输FC协议，主机端需要配置融合网卡。FCIP则需要在两个SAN网络之间IP通道IP网管支持拆解包的操作（例如Cisco MDS的IP Storage模块）。
- 都可以利用现有的高速以太网满足带宽上的需求。

 

**FCoE和FCIP在应用上的主要区别有以下几点：**

- 传输方式方面，FCIP是将FC包交由OSI第四层的TCP/IP包封装，FCoE则是直接封装在二层的以太网帧内。FCIP直接使用第三层实现处理拥堵，服务质量和传输优先权。FCOE则依赖于增强的无损以太网实现流控制，传输优先权等等。
- 由于FCIP和FCoE在封装的方式不同，FCIP可以直接使用TCP/IP网络中的路由功能，FCoE则只能通过MAC来寻址，同时管理员需要进行点对点基于WWN的Zoning配置。
- FCIP仅仅应用交换机到交换机的连接，而FCoE则是主机 – 交换机 – 存储的多方位连接。
- FCIP对以太网没有速度上的限制，而FCoE则需要起始10Gb的带宽，且是无损以太网。
- FCIP通常来说适合长距离的SAN网络的互联，数据传输，容灾需求，IPSec功能还可以为FCIP的传输进行加密。而FCoE则更适合数据中心能的网络融合，满足数据访问需求。

 

​     总结来说，FCoE和FCIP技术的出现，都是为了在已有的以太网和IP网络中使用FC来传输SCSI，让以太网可以用作存储网络之用。无论是使用FCoE基于数据中心内部和融合网络，以及FCIP实现数据中心间的存储网融合。主要的优势还是体现在成本上，虽然在维护和管理这些网络与设备也需要额外的工具与人力，而相对于节省下来维护两个独立的光纤网络和以太网所产生的成本，或者说是就未来的存储网络规划来说都是有一定的优势存在。