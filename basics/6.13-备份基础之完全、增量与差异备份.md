## 备份基础之完全、增量与差异备份

原创 *2016-06-06* *EMC中文技术社区* [EMC易安信中国技术社区](https://mp.weixin.qq.com/s?__biz=MjM5NjY0NzAwMg==&mid=2651770991&idx=1&sn=e6618e33b9a18e01411eaf8e691819b9&scene=21##)

​      如果问一个对计算机备份程序不熟悉的人，他可能会说，备份不过是把计算机上的所有数据，拷贝一份而已。换句话说，如果在星期二晚上做备份，星期三没有更动计算机上的任何数据，那么星期三晚上做的备份，与前一天晚上做的，是完全一样的，这是备份的方式之一，但实在没有必要这样做，要了解备份，我们得先知道备份的种类。

 

**备份方式:**

 

**完全备份（Full Backup）**

​      完全备份，每个档案都会被写进备份中去。如上所述，如果两个时间点备份之间，数据没有任何更动，那么所有备份数据都是一样的。这问题出自备份系统不会检查自上次备份后，档案有没有被更动过；它只是机械性地将每个档案读出、写入，不管档案有没有被修改过。备份全部选中的文件及文件夹，并不依赖文件的存盘属性来确定备份哪些文件。在备份过程中，任何现有的标记都被清除，每个文件都被标记为已备份，换言之，清除存盘属性。

​      这是我们不会一味采取完全备份的原因——每个档案都会被写到备份装置上。这表示即使所有档案都没有变动，还是会占据许多存储空间。如果每天变动的档案只有10MB，每晚却要花费100GB的存储空间做备份，这绝对不是个好方法。这也就是推出增量备份的主要原因。

**增量备份（Incremental Backup）**

​      跟完全备份不同，增量备份在做数据备份前会先判断，档案的最后修改时间是否比上次备份的时间来得晚。如果不是的话，那表示自上次备份后，这档案并没有被更动过，所以这次不需要备份。换句话说，如果修改日期的确比上次更动的日期来得晚，那么档案就被更动过，需要备份。 增量备份常常跟完全备份合用（例如每个星期做完全备份，每天做增量备份）差异备份是针对完全备份：备份上一次的完全备份后发生变化的所有文件。差异备份过程中，只备份有标记的那些选中的文件和文件夹。它不清除标记，既：备份后不标记为已备份文件，换言之，不清除存盘属性。

​      使用增量备份最大的好处在于备份速度：它的速度比完整备份快上许多，同时由于增量备份在做备份前会自动判断备份时间点及文件是否已作改动，所以相对于完全备份其对于节省存储空间也大有益处。增量备份的不足之处在于数据还原的时间较长，效率相对较低，例如，如果您要还原一个备份档案，您必须把所有增量备份的磁盘都找一遍，直到找到为止，如果您要复原整个档案系统，那就得先复原最近一次的完整备份，然后复原一个又一个的增量备份。

​      要避免复原一个又一个的递增数据，提升数据的复原的效率，把做法稍微改变一下，就变成了差异备份。

**差异备份（Differential Backup）**

****

​      差异备份与增量备份一样，都只备份更动过的数据。但前者的备份是累积的—— 一个档案只要自上次完整备份后，曾被更新过，那么接下来每次做差异备份时，这个档案都会被备份（当然，直到下一次完整备份为止）。这表示差异备份中的档案，都是自上次完全备份之后，曾被改变的档案。如果要复原整个系统，那么您只要先复原完全备份，再复原最后一次的差异备份即可。增量备份是针对于上一次备份（无论是哪种备份）：备份上一次备份后，所有发生变化的文件。增量备份过程中，只备份有标记的选中的文件和文件夹，它清除标记，既：备份后标记文件，换言之，清除存盘属性。跟增量备份所使用的策略一样，您平时只要定期做一次完全备份，再定时做差异备份即可。

 

​      所以，差异备份的大小，会随着时间过去而不断增加（假设在完全备份间，每天修改的档案都不一样）。以备份空间与速度来说，差异备份介于递增备份与完全备份之间；但不管是复原一个档案或是整个系统，速度通常比完全备份、增量备份快（因为要搜寻/复原的磁盘数目比较少）。

​      基于这些特点，差异备份是值得考虑的方案，增量备份与差异备份技术也是目前所有企业级备份软件的必备功能。

[![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)]()

 

**备份组合实例：**

 

**完全备份与差异备份**

​      以每周数据备份计划为例，我们可以在星期一进行完全备份，在星期二至星期五进行差异备份。如果在星期五数据被破坏了，则只需要还原星期一完全的备份和星期四的差异备份。这种策略备份数据需要较多的时间，但还原数据使用较少的时间。

**完全备份与增量备份**

****

​      还是以每周数据备份为例，在星期一进行完全备份，在星期二至星期五进行增量备份。如果在星期五数据被破坏了，则需要还原星期一正常的备份和从星期二至星期五的所有增量备份。这种策略备份数据需要较多的时间，但还原数据使用较少的时间。

 

**备份方式比较：**

 

完全、增量与差异备份的简单比较如下：

​                        

|      | 完全备份                  | 增量备份                       | 差异备份                                   |
| ---- | --------------------- | -------------------------- | -------------------------------------- |
| 备份方法 | 备份所有文件                | 备份自从上一次备份后的全部改动和新文件        | 备份自从上一次完全备份后的全部改动和新文件                  |
| 备份速度 | 最慢                    | 最快                         | 较快                                     |
| 恢复速度 | 最快                    | 最慢                         | 较快                                     |
| 空间要求 | 最多                    | 最少                         | 较多                                     |
| 优势   | 最快的恢复速度仅需要上一次完全备份就能恢复 | 较快的备份速度较少的空间需求没有重复的备份文件    | 更快且简单的恢复（相比增量）仅需要最近一次完全备份和最后一次差异备份就能恢复 |
| 劣势   | 最多的空间需求大量重复的备份        | 最慢的恢复速度恢复需要最近一次完全备份和全部增量备份 | 较慢的备份速度仍会存在许多重复的备份文件                   |

 